{% extends "base.html" %}

{% block content %}
    <div class="col-xs-12 show-questions">
        <div class="page-header">
            <h1>Welcome to my survey
                <small>let's see what you got</small>
            </h1>
        </div>
        {% for s in ses %}
            <div class="show-soru">
                <div class="well step">
                    <audio class="col-md-10 col-xs-12" src="/static/audio/{{ s.sound }}" controls="controls"
                           style="margin-bottom: 10px;">
                        Your browser does not support the <code>audio</code> element.
                    </audio>
<span>
                        <a class="col-md-2 col-xs-12 btn btn-default btn-next" data-name="{{ loop.index }}"
                           data-id="{{ s.id }}">
                            Start <i class="glyphicon glyphicon-hand-right"></i>
                        </a></span>

                    <div class="clearfix"></div>
                </div>
                <div class="clearfix"></div>
                {% for q in s.qs %}
                    {% if q.comment %}
                        <div class="well step"><b>{{ q.comment }}</b>

                            <textarea class="form-control cm-{{ s.id }}" name="" id="" cols="30" rows="3"
                                      style="margin: 10px 0;"></textarea>

                            <div class="">
                                <a class="btn btn-default pull-right btn-next" data-name="{{ q.id }}"
                                   data-id="c-{{ s.id }}">
                                    Next <i class="glyphicon glyphicon-hand-right"></i>
                                </a>

                                <div class="clearfix"></div>
                            </div>
                        </div>
                    {% else %}
                        <div class="well step"><b>{{ q.soru }}</b>

                            <div class="col-xs-12">
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="qm-{{ s.id }}" value="{{ q.answera }}">
                                        {{ q.answera }}
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="qm-{{ s.id }}" value="{{ q.answerb }}">
                                        {{ q.answerb }}
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="qm-{{ s.id }}" value="{{ q.answerc }}">
                                        {{ q.answerc }}
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="qm-{{ s.id }}" value="{{ q.answerd }}">
                                        {{ q.answerd }}
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="qm-{{ s.id }}" value="{{ q.answere }}">
                                        {{ q.answere }}
                                    </label>
                                </div>
                            </div>

                            <div class="">
                                <a class="btn btn-default pull-right btn-next" data-name="{{ q.id }}"
                                   data-id="m-{{ s.id }}">
                                    Next <i class="glyphicon glyphicon-hand-right"></i>
                                </a>

                                <div class="clearfix"></div>
                            </div>
                        </div>
                    {% endif %}
                {% else %}
                    <em>No questions added</em>
                {% endfor %}

            </div>
        {% endfor %}
    </div>

    <div class="col-xs-12 forms">
        <form id="form1" method="post" action="json.html" class="bbq">
            <div id="fieldWrapper">
                <div class="step" id="first">

                </div>
            </div>
        </form>
    </div>
{% endblock %}
{% block js %}

    <script>

        $(document).ready(function () {
            var h = $(".step").first().height() + 'px';
            $(".step").first().show().css("height",h);
            console.log(h);



            $(".btn-next").on("click", function () {
                var dataid = $(this).attr("data-id");
                var dataname = $(this).attr("data-name");
                if(dataid.substring(0,1)=="m"){
                    var subid = 'qm-'+dataid.substring(2);
                    var val = $("[name="+subid+"]:checked").val();
                    $.post("?multi="+dataname+"&val="+val+"&ses="+dataid.substring(2), function(){});
                    //console.log(dataid.substring(2))
                }else
                if(dataid.substring(0,1)=="c"){
                    var subid = 'cm-'+dataid.substring(2);
                    var val = $("."+subid).val();
                    console.log(val);
                    $.post("?comment="+dataname+"&val="+val+"&ses="+dataid.substring(2), function(){});
                    //console.log(dataid.substring(2))
                }
                else{
                    $.post("?sound="+dataid, function(){});
                }




                $(this).parent().parent().addClass("smaller").delay(1000).queue(function (next) {
                    $(this).remove();
                    $(".step").first().fadeIn();
                    var at = $(".step").first().height()+30 + 'px';
                    $(".step").first().css("height",at);
                    next();
                });
            });

        });

    </script>
{% endblock %}